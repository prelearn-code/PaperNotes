# è®ºæ–‡å¤ç°å®éªŒæµ‹è¯•æ–¹æ¡ˆ - åŸºäºå®é™…ä»£ç è®¾è®¡

**é¡¹ç›®æ¶æ„é›†æˆç‰ˆ v1.0**

---

## ä¸€ã€é¡¹ç›®æ•´ä½“æ¶æ„

### 1.1 ç›®å½•ç»“æ„è®¾è®¡

```
project_root/
â”œâ”€â”€ client/                          # å®¢æˆ·ç«¯æ–‡ä»¶å¤¹ï¼ˆå·²å­˜åœ¨ï¼‰
â”‚   â”œâ”€â”€ client.h
â”‚   â”œâ”€â”€ client.cpp
â”‚   â”œâ”€â”€ main.cpp
â”‚   â””â”€â”€ CMakeLists.txt
â”‚
â”œâ”€â”€ storage_node/                    # æœåŠ¡ç«¯æ–‡ä»¶å¤¹ï¼ˆå·²å­˜åœ¨ï¼‰
â”‚   â”œâ”€â”€ storage_node.h
â”‚   â”œâ”€â”€ storage_node.cpp
â”‚   â”œâ”€â”€ main.cpp
â”‚   â””â”€â”€ CMakeLists.txt
â”‚
â”œâ”€â”€ database/                        # æ•°æ®åº“æ–‡ä»¶å¤¹ï¼ˆå·²å­˜åœ¨ï¼‰
â”‚   â””â”€â”€ database1/
â”‚       â”œâ”€â”€ requisite/
â”‚       â”‚   â”œâ”€â”€ 1.
â”‚       â”‚   â”œâ”€â”€ 2.
â”‚       â”‚   â”œâ”€â”€ 3.
â”‚       â”‚   â””â”€â”€ 4.
â”‚       â””â”€â”€ human_resources/
â”‚           â””â”€â”€ 1.
â”‚
â””â”€â”€ experiment/                      # æµ‹è¯•æ–‡ä»¶å¤¹ï¼ˆæ–°å»ºï¼‰
    â”œâ”€â”€ src/                         # æµ‹è¯•æºä»£ç 
    â”‚   â”œâ”€â”€ performance_test.h       # æ€§èƒ½æµ‹è¯•å·¥å…·ç±»
    â”‚   â”œâ”€â”€ performance_test.cpp
    â”‚   â”œâ”€â”€ dataset_loader.h         # æ•°æ®é›†åŠ è½½å™¨
    â”‚   â”œâ”€â”€ dataset_loader.cpp
    â”‚   â”œâ”€â”€ gas_calculator.h         # Gasè®¡ç®—å™¨
    â”‚   â”œâ”€â”€ gas_calculator.cpp
    â”‚   â”œâ”€â”€ experiment_runner.h      # å®éªŒæ‰§è¡Œå™¨
    â”‚   â”œâ”€â”€ experiment_runner.cpp
    â”‚   â”œâ”€â”€ phase1_setup.cpp         # Phase 1ç‹¬ç«‹æµ‹è¯•
    â”‚   â”œâ”€â”€ phase2_outsourcing.cpp   # Phase 2ç‹¬ç«‹æµ‹è¯•
    â”‚   â”œâ”€â”€ phase3_search.cpp        # Phase 3ç‹¬ç«‹æµ‹è¯•
    â”‚   â””â”€â”€ main_experiment.cpp      # ä¸»æµ‹è¯•ç¨‹åº
    â”‚
    â”œâ”€â”€ data/                        # æµ‹è¯•æ•°æ®ï¼ˆå®éªŒæœŸé—´åˆ›å»ºï¼‰
    â”‚   â”œâ”€â”€ client_data/             # å®¢æˆ·ç«¯æ•°æ®ç›®å½•
    â”‚   â”‚   â”œâ”€â”€ Insert/
    â”‚   â”‚   â”œâ”€â”€ Deles/
    â”‚   â”‚   â”œâ”€â”€ EncFiles/
    â”‚   â”‚   â”œâ”€â”€ MetaFiles/
    â”‚   â”‚   â”œâ”€â”€ Search/
    â”‚   â”‚   â”œâ”€â”€ public_params.json
    â”‚   â”‚   â”œâ”€â”€ private_key.dat
    â”‚   â”‚   â”œâ”€â”€ public_key.json
    â”‚   â”‚   â””â”€â”€ keyword_states.json
    â”‚   â”‚
    â”‚   â””â”€â”€ server_data/             # æœåŠ¡ç«¯æ•°æ®ç›®å½•
    â”‚       â”œâ”€â”€ EncFiles/
    â”‚       â”œâ”€â”€ MetaFiles/
    â”‚       â”œâ”€â”€ FileProofs/
    â”‚       â”œâ”€â”€ SearchProof/
    â”‚       â”œâ”€â”€ index_database.json
    â”‚       â””â”€â”€ search_database.json
    â”‚
    â”œâ”€â”€ results/                     # æµ‹è¯•ç»“æœè¾“å‡º
    â”‚   â”œâ”€â”€ phase1_setup.json
    â”‚   â”œâ”€â”€ phase2_outsourcing.json
    â”‚   â”œâ”€â”€ phase3_search.json
    â”‚   â”œâ”€â”€ summary.json
    â”‚   â””â”€â”€ csv/
    â”‚       â”œâ”€â”€ setup_results.csv
    â”‚       â”œâ”€â”€ outsourcing_results.csv
    â”‚       â””â”€â”€ search_results.csv
    â”‚
    â”œâ”€â”€ config/                      # é…ç½®æ–‡ä»¶
    â”‚   â”œâ”€â”€ experiment_config.json   # å®éªŒé…ç½®
    â”‚   â””â”€â”€ database1_keywords.json  # å…³é”®è¯æ˜ å°„æ–‡ä»¶
    â”‚
    â”œâ”€â”€ CMakeLists.txt               # CMakeæ„å»ºæ–‡ä»¶
    â””â”€â”€ README.md                    # ä½¿ç”¨è¯´æ˜
```

---

### 1.2 ä»£ç æ¶æ„ä¿®æ”¹æ„è§

database1çš„ç»“æ„æ²¡é—®é¢˜ï¼Œä½†æ˜¯å­˜åœ¨æ•°é‡é—®é¢˜ï¼Œæ•°æ®åº“çš„æ–‡ä»¶å¤§è‡´æœ‰4000å¤šä¸ªæ–‡ä»¶ï¼Œç„¶åæ¯ä¸ªæ–‡ä»¶çš„


## äºŒã€ä»£ç é›†æˆç­–ç•¥

### 2.1 å®¢æˆ·ç«¯ä»£ç å¤ç”¨

**ç°æœ‰æ¥å£åˆ©ç”¨ï¼š**

æµ‹è¯•æ¡†æ¶å°†**ç›´æ¥è°ƒç”¨**ç°æœ‰çš„`StorageClient`ç±»ï¼Œæ— éœ€ä¿®æ”¹åŸæœ‰ä»£ç ã€‚

**å…³é”®æ¥å£æ˜ å°„ï¼š**

|æµ‹è¯•é˜¶æ®µ|ç°æœ‰æ¥å£|ç”¨é€”|
|---|---|---|
|Phase 1 Setup|`initialize(public_params_file)`|åŠ è½½å…¬å…±å‚æ•°|
||`generateKeys()`|ç”Ÿæˆå®¢æˆ·ç«¯å¯†é’¥|
||`initializeDataDirectories()`|åˆå§‹åŒ–ç›®å½•ç»“æ„|
|Phase 2 Outsourcing|`encryptFile(file_path, keywords)`|åŠ å¯†æ–‡ä»¶å¹¶ç”Ÿæˆæ ‡ç­¾|
|Phase 3 Search|`searchKeyword(keyword)`|ç”Ÿæˆæœç´¢ä»¤ç‰Œ|

**æ—¶é—´æµ‹é‡æ’å…¥ç‚¹ï¼š**

æµ‹è¯•æ¡†æ¶åœ¨**è°ƒç”¨å‰å**ä½¿ç”¨è®¡æ—¶å™¨åŒ…è£¹è¿™äº›æ¥å£ï¼š

```
ä¾‹å¦‚ï¼š
T_start = current_time()
client.encryptFile(file_path, keywords)
T_end = current_time()
encryption_time = T_end - T_start
```

**æ— éœ€ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç **ï¼Œæ‰€æœ‰æ—¶é—´æµ‹é‡åœ¨æµ‹è¯•æ¡†æ¶å±‚é¢å®Œæˆã€‚

### 2.2 æœåŠ¡ç«¯ä»£ç å¤ç”¨

**ç°æœ‰æ¥å£åˆ©ç”¨ï¼š**

æµ‹è¯•æ¡†æ¶å°†**ç›´æ¥è°ƒç”¨**ç°æœ‰çš„`StorageNode`ç±»ã€‚

**å…³é”®æ¥å£æ˜ å°„ï¼š**

| æµ‹è¯•é˜¶æ®µ                | ç°æœ‰æ¥å£                                                   | ç”¨é€”        |
| ------------------- | ------------------------------------------------------ | --------- |
| Phase 1 Setup       | `setup_cryptography(security_param, output_path)`      | åˆå§‹åŒ–å¯†ç å­¦å‚æ•°  |
|                     | `save_public_params(filepath)`                         | ä¿å­˜å…¬å…±å‚æ•°    |
| Phase 2 Outsourcing | `insert_file(param_json_path, enc_file_path)`          | æ’å…¥æ–‡ä»¶åˆ°ç´¢å¼•   |
|                     | `save_index_database()`                                | ä¿å­˜ç´¢å¼•æ•°æ®åº“   |
|                     | `save_search_database()`                               | ä¿å­˜æœç´¢æ•°æ®åº“   |
| Phase 3 Search      | `SearchKeywordsAssociatedFilesProof(search_json_path)` | æ‰§è¡Œæœç´¢å¹¶ç”Ÿæˆè¯æ˜ |
|                     | `VerifySearchProof(search_proof_json_path)`            | éªŒè¯æœç´¢è¯æ˜    |
|                     |                                                        |           |
|                     |                                                        |           |

**æ—¶é—´æµ‹é‡æ–¹å¼ï¼š**

åŒæ ·åœ¨è°ƒç”¨å‰åè®¡æ—¶ï¼Œ**æ— éœ€ä¿®æ”¹æœåŠ¡ç«¯ä»£ç **ã€‚

### 2.3 æ•°æ®æµè®¾è®¡

**å®Œæ•´æ•°æ®æµï¼š**

```
Phase 1: Setup
  StorageNode.setup_cryptography()
    â†’ ç”Ÿæˆ public_params.json
  StorageClient.initialize(public_params.json)
  StorageClient.generateKeys()
    â†’ ç”Ÿæˆ private_key.dat, public_key.json

Phase 2: Data Outsourcing
  FOR each file in database1:
    StorageClient.encryptFile(file, keywords)
      â†’ ç”Ÿæˆ EncFiles/[file].enc
      â†’ ç”Ÿæˆ Insert/[file]_insert.json
      â†’ æ›´æ–° keyword_states.json
    
    StorageNode.insert_file(insert.json, enc_file)
      â†’ æ›´æ–° index_database
      â†’ æ›´æ–° search_database

Phase 3: Search
  FOR each keyword:
    StorageClient.searchKeyword(keyword)
      â†’ ç”Ÿæˆ Search/[keyword].json
    
    StorageNode.SearchKeywordsAssociatedFilesProof(search.json)
      â†’ ç”Ÿæˆ SearchProof/[keyword]_proof.json
    
    StorageNode.VerifySearchProof(proof.json)
      â†’ è¿”å›éªŒè¯ç»“æœ
```

---

## ä¸‰ã€æµ‹è¯•æ¡†æ¶æ ¸å¿ƒç»„ä»¶

### 3.1 PerformanceTest ç±»ï¼ˆæ€§èƒ½æµ‹è¯•å·¥å…·ï¼‰

**åŠŸèƒ½å®šä½ï¼š** æä¾›è®¡æ—¶ã€æ•°æ®å¤§å°è®¡ç®—ã€é€šä¿¡æ—¶é—´è®¡ç®—ã€Gasè®¡ç®—ç­‰åº•å±‚å·¥å…·ã€‚

**æ ¸å¿ƒæ–¹æ³•ï¼š**

1. **è®¡æ—¶åŠŸèƒ½ï¼š**
    
    - `start_timer()` - å¼€å§‹è®¡æ—¶
    - `stop_timer_ms()` - åœæ­¢è®¡æ—¶ï¼Œè¿”å›æ¯«ç§’
2. **æ•°æ®å¤§å°è®¡ç®—ï¼š**
    
    - `calculate_file_size(filepath)` - è®¡ç®—æ–‡ä»¶å¤§å°
    - `calculate_json_data_size(json_obj)` - è®¡ç®—JSONå®é™…æ•°æ®å¤§å°ï¼ˆä¸å«æ ¼å¼å­—ç¬¦ï¼‰
    - `calculate_string_size(str)` - è®¡ç®—å­—ç¬¦ä¸²å­—èŠ‚å¤§å°
3. **é€šä¿¡å¼€é”€è®¡ç®—ï¼š**
    
    - `calculate_transfer_time(size_bytes, bandwidth_mbps)` - ç†è®ºä¼ è¾“æ—¶é—´
4. **ç»“æœä¿å­˜ï¼š**
    
    - `save_json_result(json_obj, filepath)` - ä¿å­˜JSONç»“æœ
    - `save_csv_result(data, filepath)` - ä¿å­˜CSVç»“æœ

**å®ç°åŸç†ï¼š** ä½¿ç”¨`std::chrono::high_resolution_clock`å®ç°é«˜ç²¾åº¦è®¡æ—¶ã€‚

### 3.2 GasCalculator ç±»ï¼ˆGasè®¡ç®—å™¨ï¼‰

**åŠŸèƒ½å®šä½ï¼š** æä¾›æ‰€æœ‰é˜¶æ®µçš„Gasæˆæœ¬è®¡ç®—ã€‚

**æ ¸å¿ƒæ–¹æ³•ï¼š**

1. `calculate_setup_gas(public_params_size)` - Setupé˜¶æ®µGas
2. `calculate_search_request_gas(T_size, st_d_size)` - æœç´¢è¯·æ±‚Gas
3. `calculate_search_proof_gas(proof_json)` - æœç´¢è¯æ˜Gasï¼ˆåŸºäºå®é™…JSONç»“æ„ï¼‰
4. `calculate_cost_eth(gas)` - Gasè½¬ETHæˆæœ¬

**Gasæ¨¡å‹å‚æ•°ï¼š**

- æ¯å­—èŠ‚Gasï¼š625
- Gasä»·æ ¼ï¼š50 Gwei
- è½¬æ¢å…¬å¼ï¼šETH = (Gas Ã— 50) / 10â¹

### 3.3 DatasetLoader ç±»ï¼ˆæ•°æ®é›†åŠ è½½å™¨ï¼‰

**åŠŸèƒ½å®šä½ï¼š** åŠ è½½database1åŠå…¶å…³é”®è¯æ˜ å°„ã€‚

**æ ¸å¿ƒæ–¹æ³•ï¼š**

1. `load_database(database_path, keywords_json_path)` - åŠ è½½æ•°æ®é›†
    - æ‰«ædatabase1ç›®å½•
    - è§£ædatabase1_keywords.json
    - æå–å”¯ä¸€å…³é”®è¯
    - è®¡ç®—ç»Ÿè®¡ä¿¡æ¯

**è¿”å›æ•°æ®ç»“æ„ï¼š**

```
DatasetInfo {
    std::string base_path;
    std::map<std::string, std::string> file_keyword_map;  // æ–‡ä»¶->å…³é”®è¯
    std::vector<std::string> all_files;
    std::set<std::string> unique_keywords;
    size_t total_size;
    int file_count;
}
```

### 3.4 ExperimentRunner ç±»ï¼ˆå®éªŒæ‰§è¡Œå™¨ï¼‰

**åŠŸèƒ½å®šä½ï¼š** ç¼–æ’å’Œæ‰§è¡Œä¸‰ä¸ªæµ‹è¯•é˜¶æ®µã€‚

**æ ¸å¿ƒæ–¹æ³•ï¼š**

1. `run_phase1_setup(num_clients)` - æ‰§è¡ŒSetupæµ‹è¯•
2. `run_phase2_outsourcing(dataset_info)` - æ‰§è¡ŒData Outsourcingæµ‹è¯•
3. `run_phase3_search(unique_keywords)` - æ‰§è¡ŒSearchæµ‹è¯•
4. `run_full_experiment(config)` - è¿è¡Œå®Œæ•´å®éªŒ

**å†…éƒ¨é›†æˆï¼š**

- åˆ›å»º`StorageClient`å’Œ`StorageNode`å®ä¾‹
- ä½¿ç”¨`PerformanceTest`è¿›è¡Œè®¡æ—¶
- ä½¿ç”¨`GasCalculator`è®¡ç®—Gas
- ä½¿ç”¨`DatasetLoader`åŠ è½½æ•°æ®
- ä¿å­˜è¯¦ç»†ç»“æœåˆ°JSONå’ŒCSV

---

## å››ã€ä¸‰é˜¶æ®µæµ‹è¯•è¯¦ç»†è®¾è®¡

### 4.1 Phase 1: Setup æµ‹è¯•

**æµ‹è¯•ç›®æ ‡ï¼š** ç‹¬ç«‹æµ‹è¯•ç³»ç»Ÿåˆå§‹åŒ–æ€§èƒ½ã€‚

**æµ‹è¯•æµç¨‹ï¼š**

```
1. åˆ›å»º StorageNode å®ä¾‹
2. æµ‹é‡å­˜å‚¨èŠ‚ç‚¹Setupï¼š
   T_setup_start = current_time()
   node.setup_cryptography(512, "experiment/data/server_data/public_params.json")
   T_setup_end = current_time()
   
   è®¡ç®—å…¬å…±å‚æ•°å¤§å°ï¼š
   pp_size = get_file_size("public_params.json")
   
   è®¡ç®—Gasï¼š
   setup_gas = GasCalculator::calculate_setup_gas(pp_size)

3. æµ‹é‡å®¢æˆ·ç«¯åˆå§‹åŒ–ï¼ˆå¯é…ç½®æ•°é‡ï¼‰ï¼š
   FOR i = 1 to num_clients:
     åˆ›å»º StorageClient å®ä¾‹
     
     T_init_start = current_time()
     client.initialize("experiment/data/server_data/public_params.json")
     T_init_end = current_time()
     
     T_keygen_start = current_time()
     client.generateKeys()
     T_keygen_end = current_time()
     
     è®¡ç®—å…¬é’¥å¤§å°ï¼š
     pk_size = get_file_size("public_key.json")
     
     è®¡ç®—Gasï¼š
     pk_gas = GasCalculator::calculate_storage_gas(pk_size)
   END FOR

4. æ±‡æ€»ç»Ÿè®¡

5. ä¿å­˜ç»“æœåˆ° results/phase1_setup.json
```

**è¾“å‡ºæŒ‡æ ‡ï¼š**

- å­˜å‚¨èŠ‚ç‚¹setupæ—¶é—´ã€å…¬å…±å‚æ•°å¤§å°ã€Gas
- å®¢æˆ·ç«¯æ€»å¯†é’¥ç”Ÿæˆæ—¶é—´ã€å¹³å‡æ—¶é—´ã€å…¬é’¥å¤§å°ã€Gas
- Setupæ€»Gaså’ŒETHæˆæœ¬

**ç‹¬ç«‹å¯æ‰§è¡Œï¼š** å¯ä»¥å•ç‹¬è¿è¡Œ`phase1_setup`ç¨‹åºï¼Œä¸ä¾èµ–å…¶ä»–é˜¶æ®µã€‚

### 4.2 Phase 2: Data Outsourcing æµ‹è¯•

**æµ‹è¯•ç›®æ ‡ï¼š** æµ‹é‡æ–‡ä»¶å¤–åŒ…å¤„ç†çš„è¯¦ç»†æ€§èƒ½ã€‚

**æµ‹è¯•æµç¨‹ï¼š**

```
1. åŠ è½½æ•°æ®é›†ï¼š
   dataset = DatasetLoader::load_database(
       "../database/database1",
       "experiment/config/database1_keywords.json"
   )

2. åˆå§‹åŒ–å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ï¼š
   client.initialize("experiment/data/server_data/public_params.json")
   client.loadKeys("experiment/data/client_data/private_key.dat")
   
   node.load_public_params("experiment/data/server_data/public_params.json")
   node.load_index_database()
   node.load_search_database()

3. å¯¹æ¯ä¸ªæ–‡ä»¶è¿›è¡Œæµ‹è¯•ï¼š
   FOR each (file_path, keyword) in dataset.file_keyword_map:
   
     ===== å®¢æˆ·ç«¯å¤„ç† =====
     T_client_start = current_time()
     
     # æ³¨æ„ï¼šencryptFileå†…éƒ¨åŒ…å«æ‰€æœ‰æ­¥éª¤
     # æˆ‘ä»¬éœ€è¦é€šè¿‡æ–‡ä»¶ç”Ÿæˆæ—¶é—´æ¥æ¨æ–­å„æ­¥éª¤æ—¶é—´
     
     client.encryptFile(file_path, [keyword])
     
     T_client_end = current_time()
     client_total_time = T_client_end - T_client_start
     
     # è®¡ç®—ä¸Šä¼ æ•°æ®å¤§å°
     enc_file_size = get_file_size("EncFiles/[file].enc")
     insert_json_size = get_file_size("Insert/[file]_insert.json")
     upload_size = enc_file_size + insert_json_size
     
     upload_transfer_time = calculate_transfer_time(upload_size, 20.0)
     
     ===== æœåŠ¡ç«¯å¤„ç† =====
     T_server_start = current_time()
     
     node.insert_file(
         "experiment/data/client_data/Insert/[file]_insert.json",
         "experiment/data/client_data/EncFiles/[file].enc"
     )
     
     T_server_end = current_time()
     server_total_time = T_server_end - T_server_start
     
     # è®°å½•å•æ–‡ä»¶ç»“æœ
     record_file_result({
         file_path, keyword, file_size,
         client_total_time, server_total_time,
         upload_size, upload_transfer_time
     })
   
   END FOR

4. æ±‡æ€»ç»Ÿè®¡ï¼š
   - æ€»æ–‡ä»¶æ•°ã€æ€»å…³é”®è¯æ•°ã€æ€»å¤§å°
   - å®¢æˆ·ç«¯æ€»æ—¶é—´ã€å¹³å‡æ—¶é—´
   - æœåŠ¡ç«¯æ€»æ—¶é—´ã€å¹³å‡æ—¶é—´
   - é€šä¿¡æ€»å¤§å°ã€æ€»ä¼ è¾“æ—¶é—´

5. ä¿å­˜ç»“æœåˆ° results/phase2_outsourcing.json
```

**ç»†åŒ–æ—¶é—´æµ‹é‡æ–¹æ¡ˆï¼š**

ç”±äº`encryptFile()`æ˜¯ä¸€ä¸ªæ•´ä½“æ¥å£ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ¡ˆç»†åŒ–æ—¶é—´ï¼š

**æ–¹æ¡ˆAï¼ˆæ¨èï¼‰ï¼šé€šè¿‡å¤šæ¬¡è°ƒç”¨æµ‹é‡å„éƒ¨åˆ†**

- å•ç‹¬è¯»å–æ–‡ä»¶ â†’ æµ‹é‡æ–‡ä»¶è¯»å–æ—¶é—´
- è°ƒç”¨encryptFile â†’ æµ‹é‡æ€»æ—¶é—´
- é€šè¿‡å·®å€¼ä¼°ç®—åŠ å¯†ã€æ ‡ç­¾ç”Ÿæˆæ—¶é—´

**æ–¹æ¡ˆBï¼šä¿®æ”¹client.cppæ·»åŠ è®¡æ—¶ç‚¹**

- åœ¨client.cppçš„encryptFile()å†…éƒ¨æ·»åŠ è®¡æ—¶ä»£ç 
- å¯¼å‡ºå„æ­¥éª¤æ—¶é—´åˆ°ç»“æœä¸­
- éœ€è¦è½»å¾®ä¿®æ”¹ç°æœ‰ä»£ç ï¼ˆæ·»åŠ å¯é€‰çš„æ€§èƒ½ç›‘æ§ï¼‰

**å»ºè®®ï¼šå…ˆä½¿ç”¨æ–¹æ¡ˆAï¼Œå¦‚éœ€æ›´ç²¾ç¡®å†è€ƒè™‘æ–¹æ¡ˆBã€‚**

**è¾“å‡ºæŒ‡æ ‡ï¼š**

- å®¢æˆ·ç«¯ï¼šæ€»æ—¶é—´ã€æ¯æ–‡ä»¶å¹³å‡æ—¶é—´ã€é€šä¿¡æ•°æ®å¤§å°
- æœåŠ¡ç«¯ï¼šæ€»æ—¶é—´ã€æ¯æ–‡ä»¶å¹³å‡æ—¶é—´
- Gasï¼š0ï¼ˆæ— ä¸Šé“¾æ“ä½œï¼‰
- å•æ–‡ä»¶è¯¦æƒ…åˆ—è¡¨

### 4.3 Phase 3: Search æµ‹è¯•

**æµ‹è¯•ç›®æ ‡ï¼š** æµ‹é‡å…³é”®è¯æœç´¢å’Œè¯æ˜ç”Ÿæˆ/éªŒè¯æ€§èƒ½ã€‚

**æµ‹è¯•æµç¨‹ï¼š**

```
1. æå–å”¯ä¸€å…³é”®è¯ï¼š
   unique_keywords = dataset.unique_keywords

2. å¯¹æ¯ä¸ªå…³é”®è¯æµ‹è¯•ï¼š
   FOR each keyword in unique_keywords:
   
     ===== å®¢æˆ·ç«¯ç”Ÿæˆæœç´¢è¯·æ±‚ =====
     T_client_start = current_time()
     
     client.searchKeyword(keyword)
     
     T_client_end = current_time()
     client_search_time = T_client_end - T_client_start
     
     # è®¡ç®—æœç´¢è¯·æ±‚å¤§å°
     search_json_path = "Search/[keyword].json"
     search_request_size = get_file_size(search_json_path)
     
     # è®¡ç®—æœç´¢è¯·æ±‚Gas
     search_request_gas = GasCalculator::calculate_search_request_gas(
         extract_T_size(search_json),
         extract_std_size(search_json)
     )
     
     ===== æœåŠ¡ç«¯æ‰§è¡Œæœç´¢ =====
     T_server_start = current_time()
     
     node.SearchKeywordsAssociatedFilesProof(search_json_path)
     
     T_server_end = current_time()
     server_search_time = T_server_end - T_server_start
     
     # è¯»å–ç”Ÿæˆçš„è¯æ˜æ–‡ä»¶
     proof_json_path = "SearchProof/[keyword]_proof.json"
     proof_json = load_json(proof_json_path)
     
     # è®¡ç®—è¯æ˜å¤§å°ï¼ˆåŸºäºå®é™…JSONç»“æ„ï¼‰
     proof_size = GasCalculator::calculate_proof_data_size(proof_json)
     
     # è®¡ç®—è¯æ˜Gas
     proof_gas = GasCalculator::calculate_search_proof_gas(proof_json)
     
     # æå–åŒ¹é…æ–‡ä»¶æ•°é‡
     num_matched = proof_json["AS"].size()
     
     ===== éªŒè¯èŠ‚ç‚¹éªŒè¯ =====
     T_verify_start = current_time()
     
     verification_passed = node.VerifySearchProof(proof_json_path)
     
     T_verify_end = current_time()
     verify_time = T_verify_end - T_verify_start
     
     # è®°å½•å•å…³é”®è¯ç»“æœ
     record_search_result({
         keyword, num_matched,
         client_search_time, search_request_size, search_request_gas,
         server_search_time, proof_size, proof_gas,
         verify_time, verification_passed
     })
   
   END FOR

3. æ±‡æ€»ç»Ÿè®¡

4. ä¿å­˜ç»“æœåˆ° results/phase3_search.json
```

**è¯æ˜å¤§å°ç²¾ç¡®è®¡ç®—ï¼š**

```
åŸºäºä½ çš„å®é™…JSONç»“æ„ï¼š
{
  "AS": [...],      // æ–‡ä»¶IDæ•°ç»„
  "PS": [...],      // æ¯ä¸ªæ–‡ä»¶çš„è¯æ˜
  "T": "...",
  "phi": "...",
  "seed": "...",
  "std": "..."
}

è®¡ç®—æ–¹æ³•ï¼š
proof_size = 0

// ASæ•°ç»„
for (auto& id : proof_json["AS"]):
    proof_size += id.asString().length() / 2  // hexè½¬å­—èŠ‚

// PSæ•°ç»„
for (auto& entry : proof_json["PS"]):
    proof_size += entry["ID_F"].asString().length() / 2
    proof_size += entry["phi_alpha"].asString().length() / 2
    proof_size += entry["psi_alpha"].asString().length() / 2

// å…¶ä»–å­—æ®µ
proof_size += proof_json["T"].asString().length() / 2
proof_size += proof_json["phi"].asString().length() / 2
proof_size += proof_json["seed"].asString().length() / 2
proof_size += proof_json["std"].asString().length() / 2
```

**è¾“å‡ºæŒ‡æ ‡ï¼š**

- æ¯ä¸ªå…³é”®è¯ï¼šå®¢æˆ·ç«¯æ—¶é—´ã€æœåŠ¡ç«¯æ—¶é—´ã€éªŒè¯æ—¶é—´
- è¯æ˜å¤§å°ã€åŒ¹é…æ–‡ä»¶æ•°
- Gasæˆæœ¬ï¼ˆè¯·æ±‚+è¯æ˜ï¼‰
- æ±‡æ€»ç»Ÿè®¡

---

## äº”ã€CMakeæ„å»ºç³»ç»Ÿè®¾è®¡

### 5.1 ä¸»CMakeLists.txtï¼ˆexperiment/CMakeLists.txtï¼‰

**è®¾è®¡åŸåˆ™ï¼š**

- é“¾æ¥åˆ°ç°æœ‰çš„clientå’Œstorage_nodeä»£ç ï¼ˆä½œä¸ºåº“ï¼‰
- åŒ…å«æ‰€æœ‰å¿…è¦çš„ä¾èµ–åº“
- ç”Ÿæˆå¤šä¸ªå¯æ‰§è¡Œæ–‡ä»¶

**æ ¸å¿ƒç»“æ„ï¼š**

```cmake
cmake_minimum_required(VERSION 3.10)
project(ExperimentFramework VERSION 1.0)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# ========== æŸ¥æ‰¾ä¾èµ–åº“ ==========
find_package(OpenSSL REQUIRED)
find_package(CURL REQUIRED)
find_package(PkgConfig REQUIRED)

pkg_check_modules(GMP REQUIRED gmp)
set(PBC_INCLUDE_DIRS "/usr/local/include")
set(PBC_LIBRARIES "/usr/local/lib/libpbc.so")
pkg_check_modules(JSONCPP REQUIRED jsoncpp)

# ========== åŒ…å«ç›®å½• ==========
include_directories(
    ${CMAKE_CURRENT_SOURCE_DIR}/src
    ${CMAKE_CURRENT_SOURCE_DIR}/../client      # å®¢æˆ·ç«¯å¤´æ–‡ä»¶
    ${CMAKE_CURRENT_SOURCE_DIR}/../storage_node  # æœåŠ¡ç«¯å¤´æ–‡ä»¶
    ${OPENSSL_INCLUDE_DIR}
    ${CURL_INCLUDE_DIRS}
    ${PBC_INCLUDE_DIRS}
    ${GMP_INCLUDE_DIRS}
    ${JSONCPP_INCLUDE_DIRS}
)

# ========== ç¼–è¯‘ç°æœ‰ä»£ç ä¸ºåº“ ==========

# å®¢æˆ·ç«¯åº“
add_library(storage_client STATIC
    ../client/client.cpp
)

# æœåŠ¡ç«¯åº“
add_library(storage_node_lib STATIC
    ../storage_node/storage_node.cpp
)

# ========== æµ‹è¯•æ¡†æ¶åº“ ==========
add_library(experiment_framework STATIC
    src/performance_test.cpp
    src/gas_calculator.cpp
    src/dataset_loader.cpp
    src/experiment_runner.cpp
)

# ========== å¯æ‰§è¡Œæ–‡ä»¶ ==========

# Phase 1: Setupæµ‹è¯•
add_executable(phase1_setup
    src/phase1_setup.cpp
)
target_link_libraries(phase1_setup
    storage_client
    storage_node_lib
    experiment_framework
    ${PBC_LIBRARIES}
    ${GMP_LIBRARIES}
    ${JSONCPP_LIBRARIES}
    ${OPENSSL_LIBRARIES}
    ${CURL_LIBRARIES}
)

# Phase 2: Data Outsourcingæµ‹è¯•
add_executable(phase2_outsourcing
    src/phase2_outsourcing.cpp
)
target_link_libraries(phase2_outsourcing
    storage_client
    storage_node_lib
    experiment_framework
    ${PBC_LIBRARIES}
    ${GMP_LIBRARIES}
    ${JSONCPP_LIBRARIES}
    ${OPENSSL_LIBRARIES}
    ${CURL_LIBRARIES}
)

# Phase 3: Searchæµ‹è¯•
add_executable(phase3_search
    src/phase3_search.cpp
)
target_link_libraries(phase3_search
    storage_client
    storage_node_lib
    experiment_framework
    ${PBC_LIBRARIES}
    ${GMP_LIBRARIES}
    ${JSONCPP_LIBRARIES}
    ${OPENSSL_LIBRARIES}
    ${CURL_LIBRARIES}
)

# å®Œæ•´å®éªŒç¨‹åº
add_executable(full_experiment
    src/main_experiment.cpp
)
target_link_libraries(full_experiment
    storage_client
    storage_node_lib
    experiment_framework
    ${PBC_LIBRARIES}
    ${GMP_LIBRARIES}
    ${JSONCPP_LIBRARIES}
    ${OPENSSL_LIBRARIES}
    ${CURL_LIBRARIES}
)

# ========== ç¼–è¯‘é€‰é¡¹ ==========
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Wextra")
set(CMAKE_CXX_FLAGS_DEBUG "-g -O0")
set(CMAKE_CXX_FLAGS_RELEASE "-O3 -DNDEBUG")
```

### 5.2 æ„å»ºå’Œè¿è¡Œæµç¨‹

**æ„å»ºæ­¥éª¤ï¼š**

```bash
# 1. è¿›å…¥æµ‹è¯•ç›®å½•
cd experiment

# 2. åˆ›å»ºæ„å»ºç›®å½•
mkdir build
cd build

# 3. è¿è¡ŒCMake
cmake ..

# 4. ç¼–è¯‘
make

# æˆ–è€…ç¼–è¯‘ç‰¹å®šç›®æ ‡
make phase1_setup
make phase2_outsourcing
make phase3_search
make full_experiment
```

**è¿è¡Œæ­¥éª¤ï¼š**

```bash
# åœ¨ experiment/build/ ç›®å½•ä¸‹

# è¿è¡Œå®Œæ•´å®éªŒ
./full_experiment

# æˆ–å•ç‹¬è¿è¡Œå„é˜¶æ®µ
./phase1_setup --num-clients 10
./phase2_outsourcing --database ../database/database1
./phase3_search

# æŸ¥çœ‹ç»“æœ
cat ../results/summary.json
```

---

## å…­ã€é…ç½®æ–‡ä»¶è®¾è®¡

### 6.1 experiment_config.json

**ç”¨é€”ï¼š** é…ç½®å®éªŒå‚æ•°ã€‚

**å†…å®¹ç¤ºä¾‹ï¼š**

```json
{
  "experiment_name": "database1_test",
  "timestamp": "2025-12-13T15:00:00Z",
  
  "paths": {
    "database_path": "../database/database1",
    "keywords_json": "config/database1_keywords.json",
    "client_data_dir": "data/client_data",
    "server_data_dir": "data/server_data",
    "results_dir": "results"
  },
  
  "parameters": {
    "security_param": 512,
    "num_clients": 10,
    "bandwidth_mbps": 20.0,
    "gas_price_gwei": 50.0
  },
  
  "phases": {
    "run_setup": true,
    "run_outsourcing": true,
    "run_search": true
  }
}
```

### 6.2 database1_keywords.json

**ç”¨é€”ï¼š** å­˜å‚¨æ–‡ä»¶åˆ°å…³é”®è¯çš„æ˜ å°„ã€‚

**å†…å®¹æ ¼å¼ï¼š**

```json
{
  "../database/database1/requisite/4.": "software",
  "../database/database1/requisite/2.": "cross-sell",
  "../database/database1/requisite/3.": "requisite",
  "../database/database1/human_resources/1.": "benefits",
  "../database/database1/requisite/1.": "cross-sell"
}
```

**ç”Ÿæˆæ–¹å¼ï¼š**

- æ‰‹åŠ¨åˆ›å»º
- æˆ–é€šè¿‡è„šæœ¬æ‰«ædatabase1è‡ªåŠ¨ç”Ÿæˆ

---

## ä¸ƒã€æ•°æ®å‡†å¤‡å’Œæ¸…ç†

### 7.1 åˆå§‹åŒ–è„šæœ¬

**åˆ›å»º experiment/scripts/init_experiment.shï¼š**

```bash
#!/bin/bash

# åˆ›å»ºå¿…è¦çš„ç›®å½•ç»“æ„
mkdir -p data/client_data/{Insert,Deles,EncFiles,MetaFiles,Search}
mkdir -p data/server_data/{EncFiles,MetaFiles,FileProofs,SearchProof}
mkdir -p results/csv
mkdir -p config

# å¤åˆ¶é…ç½®æ–‡ä»¶æ¨¡æ¿
if [ ! -f config/experiment_config.json ]; then
    cp config_templates/experiment_config.json config/
fi

if [ ! -f config/database1_keywords.json ]; then
    echo "è¯·æ‰‹åŠ¨åˆ›å»º config/database1_keywords.json"
fi

echo "å®éªŒç¯å¢ƒåˆå§‹åŒ–å®Œæˆ"
```

### 7.2 æ¸…ç†è„šæœ¬

**åˆ›å»º experiment/scripts/clean_experiment.shï¼š**

```bash
#!/bin/bash

# æ¸…ç†æµ‹è¯•æ•°æ®
rm -rf data/client_data/*
rm -rf data/server_data/*
rm -rf results/*

echo "å®éªŒæ•°æ®å·²æ¸…ç†"
```

---

## å…«ã€å…³é”®å®ç°ç»†èŠ‚

### 8.1 è·¯å¾„ç®¡ç†ç­–ç•¥

**é—®é¢˜ï¼š** client.cppå’Œstorage_node.cppä½¿ç”¨ç›¸å¯¹è·¯å¾„`../data`

**è§£å†³æ–¹æ¡ˆï¼š**

åœ¨æµ‹è¯•æ¡†æ¶ä¸­ï¼Œåˆ›å»ºç¬¦åˆé¢„æœŸçš„ç›®å½•ç»“æ„ï¼š

```
experiment/
  data/
    client_data/  â†’ è®¾ç½®ä¸ºå®¢æˆ·ç«¯çš„å·¥ä½œç›®å½•
    server_data/  â†’ è®¾ç½®ä¸ºæœåŠ¡ç«¯çš„å·¥ä½œç›®å½•
```

åœ¨ä»£ç ä¸­åˆå§‹åŒ–æ—¶æŒ‡å®šæ•°æ®ç›®å½•ï¼š

```cpp
// å®¢æˆ·ç«¯
StorageClient client;
// ä¿®æ”¹å®¢æˆ·ç«¯çš„DATA_DIRå¸¸é‡æŒ‡å‘ experiment/data/client_data
// æˆ–é€šè¿‡ç¯å¢ƒå˜é‡/é…ç½®æ–‡ä»¶æŒ‡å®š

// æœåŠ¡ç«¯
StorageNode node("experiment/data/server_data", 9000);
```

### 8.2 æ—¶é—´æµ‹é‡ç²¾åº¦

**ä½¿ç”¨é«˜ç²¾åº¦è®¡æ—¶å™¨ï¼š**

```cpp
#include <chrono>

auto t_start = std::chrono::high_resolution_clock::now();
// ... æ‰§è¡Œæ“ä½œ ...
auto t_end = std::chrono::high_resolution_clock::now();

auto duration = std::chrono::duration_cast<std::chrono::milliseconds>(
    t_end - t_start
);
double time_ms = duration.count();
```

### 8.3 JSONæ•°æ®å¤§å°è®¡ç®—

**ç²¾ç¡®è®¡ç®—ï¼ˆä¸å«æ ¼å¼å­—ç¬¦ï¼‰ï¼š**

```cpp
size_t calculate_json_data_size(const Json::Value& json) {
    size_t total_size = 0;
    
    // éå†JSONå¯¹è±¡
    for (auto& key : json.getMemberNames()) {
        const Json::Value& value = json[key];
        
        if (value.isString()) {
            std::string str = value.asString();
            // hexå­—ç¬¦ä¸²è½¬å­—èŠ‚
            if (is_hex_string(str)) {
                total_size += str.length() / 2;
            } else {
                total_size += str.length();
            }
        } else if (value.isArray()) {
            for (auto& item : value) {
                total_size += calculate_json_data_size(item);
            }
        } else if (value.isObject()) {
            total_size += calculate_json_data_size(value);
        }
    }
    
    return total_size;
}
```

### 8.4 å¤šæ¬¡æµ‹è¯•å–å¹³å‡å€¼

**å»ºè®®ï¼š** æ¯ä¸ªæµ‹è¯•è¿è¡Œ3-5æ¬¡ï¼Œå–å¹³å‡å€¼ä»¥å‡å°‘è¯¯å·®ã€‚

```cpp
std::vector<double> times;
for (int i = 0; i < 3; i++) {
    auto t_start = current_time();
    // ... æ‰§è¡Œæµ‹è¯• ...
    auto t_end = current_time();
    times.push_back(t_end - t_start);
}

double avg_time = std::accumulate(times.begin(), times.end(), 0.0) / times.size();
```

---

## ä¹ã€é¢„æœŸè¾“å‡ºç¤ºä¾‹

### 9.1 æ§åˆ¶å°è¾“å‡º

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š è®ºæ–‡å¤ç°å®éªŒæ¡†æ¶ v1.0
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[Phase 1] Setupæµ‹è¯•
  â†’ å­˜å‚¨èŠ‚ç‚¹setup: 1523.45 ms
  â†’ å…¬å…±å‚æ•°å¤§å°: 1024 bytes
  â†’ å…¬å…±å‚æ•°Gas: 640000 (0.032 ETH)
  â†’ å®¢æˆ·ç«¯æ•°é‡: 10
  â†’ å¹³å‡å¯†é’¥ç”Ÿæˆæ—¶é—´: 45.68 ms
  â†’ Setupæ€»Gas: 1440000 (0.072 ETH)
  âœ“ Phase 1 å®Œæˆ

[Phase 2] Data Outsourcingæµ‹è¯•
  â†’ æ•°æ®é›†: database1
  â†’ æ–‡ä»¶æ•°: 5
  â†’ å…³é”®è¯æ•°: 4
  â†’ å®¢æˆ·ç«¯æ€»æ—¶é—´: 456.78 ms
  â†’ æœåŠ¡ç«¯æ€»æ—¶é—´: 345.67 ms
  â†’ ä¸Šä¼ æ•°æ®å¤§å°: 35.2 KB
  â†’ Gas: 0 (æ— ä¸Šé“¾æ“ä½œ)
  âœ“ Phase 2 å®Œæˆ

[Phase 3] Verifiable Searchæµ‹è¯•
  â†’ å…³é”®è¯æ•°: 4
  â†’ å¹³å‡å®¢æˆ·ç«¯æ—¶é—´: 0.15 ms
  â†’ å¹³å‡æœåŠ¡ç«¯æ—¶é—´: 62.34 ms
  â†’ å¹³å‡éªŒè¯æ—¶é—´: 21.23 ms
  â†’ å¹³å‡è¯æ˜å¤§å°: 478 bytes
  â†’ æ€»Gas: 1560000 (0.078 ETH)
  âœ“ Phase 3 å®Œæˆ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
å®éªŒæ€»ç»“ï¼š
  æ€»è¿è¡Œæ—¶é—´: 2.34 ç§’
  æ€»Gasæˆæœ¬: 3000000 (0.15 ETH)
  ç»“æœå·²ä¿å­˜åˆ°: experiment/results/
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### 9.2 JSONç»“æœæ–‡ä»¶

**results/summary.jsonï¼š**

```json
{
  "experiment_info": {
    "name": "database1_test",
    "timestamp": "2025-12-13T15:30:00Z",
    "total_runtime_s": 2.34
  },
  
  "phase1_setup": {
    "storage_node_time_ms": 1523.45,
    "client_avg_time_ms": 45.68,
    "total_gas": 1440000,
    "total_cost_eth": 0.072
  },
  
  "phase2_outsourcing": {
    "total_files": 5,
    "client_total_time_ms": 456.78,
    "server_total_time_ms": 345.67,
    "total_gas": 0
  },
  
  "phase3_search": {
    "total_keywords": 4,
    "avg_server_time_ms": 62.34,
    "avg_verify_time_ms": 21.23,
    "total_gas": 1560000,
    "total_cost_eth": 0.078
  },
  
  "total_cost": {
    "total_gas": 3000000,
    "total_eth": 0.15
  }
}
```

---

## åã€å¼€å‘å’Œæµ‹è¯•è®¡åˆ’

### 10.1 å¼€å‘é¡ºåº

**ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æ¡†æ¶**

1. PerformanceTestç±»
2. GasCalculatorç±»
3. DatasetLoaderç±»

**ç¬¬äºŒé˜¶æ®µï¼šPhase 1æµ‹è¯•** 4. phase1_setup.cpp 5. æµ‹è¯•å’ŒéªŒè¯

**ç¬¬ä¸‰é˜¶æ®µï¼šPhase 2æµ‹è¯•** 6. phase2_outsourcing.cpp 7. æµ‹è¯•å’ŒéªŒè¯

**ç¬¬å››é˜¶æ®µï¼šPhase 3æµ‹è¯•** 8. phase3_search.cpp 9. æµ‹è¯•å’ŒéªŒè¯

**ç¬¬äº”é˜¶æ®µï¼šé›†æˆ** 10. ExperimentRunnerç±» 11. main_experiment.cpp 12. å®Œæ•´æµ‹è¯•

### 10.2 æµ‹è¯•éªŒè¯ç‚¹

**åŸºç¡€åŠŸèƒ½éªŒè¯ï¼š**

- [ ] CMakeèƒ½æ­£ç¡®ç¼–è¯‘æ‰€æœ‰ç›®æ ‡
- [ ] èƒ½æ­£ç¡®é“¾æ¥clientå’Œstorage_nodeåº“
- [ ] è®¡æ—¶å™¨ç²¾åº¦æ»¡è¶³è¦æ±‚ï¼ˆæ¯«ç§’çº§ï¼‰
- [ ] æ–‡ä»¶å¤§å°è®¡ç®—å‡†ç¡®
- [ ] Gasè®¡ç®—å…¬å¼æ­£ç¡®

**Phase 1éªŒè¯ï¼š**

- [ ] StorageNode.setup_cryptography()æ­£å¸¸æ‰§è¡Œ
- [ ] å…¬å…±å‚æ•°æ–‡ä»¶æ­£ç¡®ç”Ÿæˆ
- [ ] å®¢æˆ·ç«¯èƒ½æ­£ç¡®åŠ è½½å…¬å…±å‚æ•°
- [ ] å¯†é’¥ç”ŸæˆæˆåŠŸ
- [ ] æ—¶é—´å’ŒGasè®¡ç®—å‡†ç¡®

**Phase 2éªŒè¯ï¼š**

- [ ] èƒ½æ­£ç¡®åŠ è½½database1
- [ ] èƒ½æ­£ç¡®è§£ækeywords.json
- [ ] å®¢æˆ·ç«¯encryptFileæ­£å¸¸å·¥ä½œ
- [ ] æœåŠ¡ç«¯insert_fileæ­£å¸¸å·¥ä½œ
- [ ] æ‰€æœ‰æ–‡ä»¶å¤„ç†æˆåŠŸ
- [ ] æ—¶é—´ç»Ÿè®¡å‡†ç¡®

**Phase 3éªŒè¯ï¼š**

- [ ] å®¢æˆ·ç«¯searchKeywordæ­£å¸¸å·¥ä½œ
- [ ] æœåŠ¡ç«¯SearchKeywordsAssociatedFilesProofæ­£å¸¸å·¥ä½œ
- [ ] è¯æ˜æ–‡ä»¶æ­£ç¡®ç”Ÿæˆ
- [ ] VerifySearchProoféªŒè¯é€šè¿‡
- [ ] è¯æ˜å¤§å°è®¡ç®—å‡†ç¡®
- [ ] Gasè®¡ç®—å‡†ç¡®

**ç»“æœéªŒè¯ï¼š**

- [ ] JSONç»“æœæ ¼å¼æ­£ç¡®
- [ ] CSVç»“æœæ ¼å¼æ­£ç¡®
- [ ] æ•°æ®å®Œæ•´æ— é—æ¼
- [ ] ç»Ÿè®¡è®¡ç®—å‡†ç¡®

---

## åä¸€ã€æ½œåœ¨é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### 11.1 è·¯å¾„é—®é¢˜

**é—®é¢˜ï¼š** client.cppå’Œstorage_node.cppç¡¬ç¼–ç äº†`../data`è·¯å¾„ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

1. åœ¨experimentç›®å½•ä¸‹åˆ›å»ºç¬¦åˆé¢„æœŸçš„dataç›®å½•ç»“æ„
2. æˆ–ä¿®æ”¹StorageClientå’ŒStorageNodeçš„æ„é€ å‡½æ•°ï¼Œå…è®¸ä¼ å…¥è‡ªå®šä¹‰æ•°æ®ç›®å½•

### 11.2 æ–‡ä»¶å†²çªé—®é¢˜

**é—®é¢˜ï¼š** å¤šæ¬¡è¿è¡Œæµ‹è¯•å¯èƒ½äº§ç”Ÿæ–‡ä»¶å†²çªã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ¯æ¬¡æµ‹è¯•å‰æ¸…ç†dataç›®å½•
2. æˆ–ä¸ºæ¯æ¬¡æµ‹è¯•åˆ›å»ºå¸¦æ—¶é—´æˆ³çš„å­ç›®å½•

### 11.3 å¤§æ•°æ®é›†æ€§èƒ½é—®é¢˜

**é—®é¢˜ï¼š** database1åªæœ‰5ä¸ªæ–‡ä»¶ï¼Œæµ‹è¯•æ—¶é—´å¾ˆçŸ­ï¼Œå¯èƒ½æ— æ³•å……åˆ†å±•ç¤ºæ€§èƒ½ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

1. æä¾›ç”Ÿæˆæ›´å¤§æµ‹è¯•æ•°æ®é›†çš„è„šæœ¬
2. æ”¯æŒå¤šæ¬¡é‡å¤è¿è¡Œä»¥è·å¾—æ›´ç¨³å®šçš„ç»“æœ

### 11.4 ç»†åŒ–æ—¶é—´æµ‹é‡é—®é¢˜

**é—®é¢˜ï¼š** encryptFile()æ˜¯æ•´ä½“æ¥å£ï¼Œæ— æ³•ç»†åŒ–å„æ­¥éª¤æ—¶é—´ã€‚

**è§£å†³æ–¹æ¡ˆï¼ˆå¯é€‰ï¼‰ï¼š** åœ¨client.cppä¸­æ·»åŠ æ€§èƒ½ç›‘æ§æ”¯æŒï¼š

- æ·»åŠ ä¸€ä¸ªå¯é€‰çš„æ€§èƒ½å›è°ƒå‡½æ•°
- åœ¨å„å…³é”®æ­¥éª¤è°ƒç”¨å›è°ƒè®°å½•æ—¶é—´
- æµ‹è¯•æ¡†æ¶é€šè¿‡å›è°ƒè·å–è¯¦ç»†æ—¶é—´

---

## åäºŒã€æ–¹æ¡ˆæ€»ç»“

### 12.1 æ ¸å¿ƒä¼˜åŠ¿

1. **æ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç **
    
    - ç›´æ¥å¤ç”¨clientå’Œstorage_nodeä»£ç 
    - ä»…é€šè¿‡å¤–éƒ¨åŒ…è£…è¿›è¡Œæµ‹è¯•
2. **å®Œæ•´çš„CMakeé›†æˆ**
    
    - è‡ªåŠ¨åŒ–æ„å»ºæµç¨‹
    - æ¸…æ™°çš„ä¾èµ–ç®¡ç†
3. **æ¨¡å—åŒ–è®¾è®¡**
    
    - å„é˜¶æ®µç‹¬ç«‹å¯æµ‹è¯•
    - ä¾¿äºè°ƒè¯•å’ŒéªŒè¯
4. **è¯¦ç»†çš„ç»“æœè¾“å‡º**
    
    - JSONæ ¼å¼ï¼ˆç¨‹åºå¯è¯»ï¼‰
    - CSVæ ¼å¼ï¼ˆExcel/Pythonå¯è¯»ï¼‰
    - æ§åˆ¶å°å‹å¥½æ˜¾ç¤º
5. **ç¬¦åˆè®ºæ–‡è¦æ±‚**
    
    - ä¸‰é˜¶æ®µå®Œæ•´è¦†ç›–
    - æŒ‡æ ‡å®šä¹‰å‡†ç¡®
    - Gasè®¡ç®—ç²¾ç¡®

### 12.2 å®æ–½å»ºè®®

**ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºç›®å½•ç»“æ„**

```bash
cd project_root
mkdir -p experiment/{src,data,results,config,scripts}
```

**ç¬¬äºŒæ­¥ï¼šå‡†å¤‡é…ç½®æ–‡ä»¶**

- åˆ›å»ºexperiment_config.json
- åˆ›å»ºdatabase1_keywords.json

**ç¬¬ä¸‰æ­¥ï¼šé€æ­¥å®ç°**

- å…ˆå®ç°åŸºç¡€ç±»ï¼ˆPerformanceTest, GasCalculator, DatasetLoaderï¼‰
- å†å®ç°Phase 1æµ‹è¯•
- é€æ­¥å®ŒæˆPhase 2å’ŒPhase 3

**ç¬¬å››æ­¥ï¼šæµ‹è¯•éªŒè¯**

- å°æ•°æ®é›†æµ‹è¯•
- éªŒè¯ç»“æœæ­£ç¡®æ€§
- ä¼˜åŒ–æ€§èƒ½

---

## æ–¹æ¡ˆå®¡æ ¸æ¸…å•

### æ¶æ„è®¾è®¡ âœ“

- [x] ç›®å½•ç»“æ„æ¸…æ™°åˆç†
- [x] ä»£ç å¤ç”¨ç­–ç•¥æ˜ç¡®
- [x] æ•°æ®æµè®¾è®¡å®Œæ•´

### æµ‹è¯•æ¡†æ¶ âœ“

- [x] æ ¸å¿ƒç±»è®¾è®¡åˆç†
- [x] æ¥å£å®šä¹‰æ¸…æ™°
- [x] åŠŸèƒ½åˆ’åˆ†æ˜ç¡®

### ä¸‰é˜¶æ®µæµ‹è¯• âœ“

- [x] Phase 1: Setupå®Œæ•´
- [x] Phase 2: Outsourcingå®Œæ•´
- [x] Phase 3: Searchå®Œæ•´
- [x] æ‰€æœ‰æµ‹è¯•æŒ‡æ ‡è¦†ç›–

### CMakeæ„å»º âœ“

- [x] ä¾èµ–ç®¡ç†æ­£ç¡®
- [x] ç¼–è¯‘ç›®æ ‡æ˜ç¡®
- [x] é“¾æ¥é…ç½®æ­£ç¡®

### å®æ–½è®¡åˆ’ âœ“

- [x] å¼€å‘é¡ºåºåˆç†
- [x] éªŒè¯ç‚¹å®Œæ•´
- [x] é—®é¢˜é¢„æ¡ˆå……åˆ†

---

**æ–¹æ¡ˆå·²å®Œæˆï¼è¯·å®¡æ ¸ä»¥ä¸‹å…³é”®ç‚¹ï¼š**

1. **æ¶æ„æ˜¯å¦åˆç†ï¼Ÿ**
    
    - æµ‹è¯•æ¡†æ¶ä¸ç°æœ‰ä»£ç çš„é›†æˆæ–¹å¼
    - ç›®å½•ç»“æ„è®¾è®¡
2. **æµ‹è¯•æµç¨‹æ˜¯å¦å®Œæ•´ï¼Ÿ**
    
    - ä¸‰ä¸ªé˜¶æ®µçš„æµ‹è¯•é€»è¾‘
    - æ—¶é—´æµ‹é‡æ–¹æ¡ˆ
    - Gasè®¡ç®—æ–¹æ¡ˆ
3. **CMakeæ„å»ºæ˜¯å¦å¯è¡Œï¼Ÿ**
    
    - é“¾æ¥ç°æœ‰ä»£ç ä½œä¸ºåº“
    - ç”Ÿæˆå¤šä¸ªå¯æ‰§è¡Œæ–‡ä»¶
4. **æ˜¯å¦éœ€è¦ä¿®æ”¹ç°æœ‰ä»£ç ï¼Ÿ**
    
    - å½“å‰æ–¹æ¡ˆå°½é‡ä¸ä¿®æ”¹
    - å¦‚éœ€ç»†åŒ–æ—¶é—´ï¼Œæ˜¯å¦æ¥å—è½»å¾®ä¿®æ”¹
5. **æ˜¯å¦éœ€è¦è°ƒæ•´ï¼Ÿ**
    
    - æœ‰ä»»ä½•ä¸æ¸…æ¥šæˆ–éœ€è¦æ”¹è¿›çš„åœ°æ–¹

å®¡æ ¸é€šè¿‡åï¼Œæˆ‘å°†å¼€å§‹ç”Ÿæˆå…·ä½“çš„ä»£ç å®ç°ï¼ğŸ“